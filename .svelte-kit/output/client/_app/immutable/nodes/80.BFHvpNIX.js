var je=Object.defineProperty;var Ue=(n,c,i)=>c in n?je(n,c,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[c]=i;var A=(n,c,i)=>Ue(n,typeof c!="symbol"?c+"":c,i);import"../chunks/Bzak7iHL.js";import"../chunks/DW9ov6mQ.js";import{o as He,a as We}from"../chunks/BKdxYII_.js";import{p as qe,d as _,h as u,e as o,t as G,g as r,m as k,i as M,s,j as g,a as x,b as Qe,r as a,aw as L,c as $e,f as he}from"../chunks/DFw88cu1.js";import{i as S}from"../chunks/CtMEnX0n.js";import{e as be,i as pe}from"../chunks/BTPm-04w.js";import{r as ge}from"../chunks/-87vorbC.js";import{b as ye}from"../chunks/DDIA5LkU.js";import{i as Je}from"../chunks/BNOMXApT.js";import{I as b}from"../chunks/kCJPNK6s.js";import{s as Ke,a as Oe}from"../chunks/CfCzXxk-.js";import{buildMusicPrompt as Xe,generateMusic as Ye,getTemplatePrompt as Ze}from"../chunks/BKKHa0w5.js";class et{constructor(){A(this,"audioContext",null);A(this,"currentSource",null);A(this,"gainNode",null);A(this,"isPlaying",!1);A(this,"currentBuffer",null);this.initializeAudioContext()}async initializeAudioContext(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}catch(c){throw console.error("Failed to initialize audio context:",c),c}}async playAudio(c,i={}){var v;if((!this.audioContext||!this.gainNode)&&await this.initializeAudioContext(),!this.audioContext||!this.gainNode)throw new Error("Audio context not available");try{this.audioContext.state==="suspended"&&await this.audioContext.resume(),this.stopAudio(),this.currentSource=this.audioContext.createBufferSource(),this.currentSource.buffer=c,this.currentBuffer=c;const d=Math.max(0,Math.min(i.volume??1,1));this.gainNode.gain.value=d,this.currentSource.connect(this.gainNode),this.currentSource.onended=()=>{var h;this.isPlaying=!1,(h=i.onEnded)==null||h.call(i)},i.loop&&(this.currentSource.loop=!0),this.currentSource.start(),this.isPlaying=!0}catch(d){throw console.error("Audio playback failed:",d),this.isPlaying=!1,(v=i.onError)==null||v.call(i,d),d}}stopAudio(){if(this.currentSource){try{this.currentSource.stop()}catch{}this.currentSource=null}this.isPlaying=!1}pauseAudio(){this.audioContext&&this.isPlaying&&(this.audioContext.suspend(),this.isPlaying=!1)}resumeAudio(){this.audioContext&&!this.isPlaying&&(this.audioContext.resume(),this.isPlaying=!0)}setVolume(c){this.gainNode&&(this.gainNode.gain.value=Math.max(0,Math.min(c,1)))}get isCurrentlyPlaying(){return this.isPlaying}get currentAudioBuffer(){return this.currentBuffer}getDuration(){var c;return((c=this.currentBuffer)==null?void 0:c.duration)??0}getCurrentTime(){return!this.audioContext||!this.currentSource?0:this.audioContext.currentTime}}let $=null;function E(){if(typeof window>"u")throw new Error("AudioPlayer can only be used in browser environment");return $||($=new et),$}async function tt(n,c){return typeof window>"u"?void 0:E().playAudio(n,c)}function we(){if(typeof window>"u")return;E().stopAudio()}function J(){if(typeof window>"u")return;E().pauseAudio()}function it(){if(typeof window>"u")return;E().resumeAudio()}function xe(n){if(typeof window>"u")return;E().setVolume(n)}async function at(n={}){if(typeof window>"u")throw new Error("Microphone recording is only available in browser environment");return new Promise((c,i)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(v=>{const d=new MediaRecorder(v),h=[];d.ondataavailable=m=>{var f;h.push(m.data),(f=n.onData)==null||f.call(n,m.data)},d.onstop=()=>{const m=new Blob(h,{type:"audio/wav"});c(m),v.getTracks().forEach(f=>f.stop())},d.onerror=m=>{var C;const f=new Error("Recording failed");(C=n.onError)==null||C.call(n,f),i(f)},d.start(),n.duration&&setTimeout(()=>{d.stop()},n.duration*1e3)}).catch(v=>{var d;console.error("Microphone access denied:",v),(d=n.onError)==null||d.call(n,v),i(v)})})}async function ot(n){if(typeof window>"u")throw new Error("Audio processing is only available in browser environment");const c=await n.arrayBuffer();return await new(window.AudioContext||window.webkitAudioContext)().decodeAudioData(c)}var nt=_('<button class="btn btn-error"><!> Stop Listening</button>'),rt=_('<button class="btn btn-primary"><!> Start Listening</button>'),st=_('<p class="text-sm text-base-content/60 mt-2"><strong>Last prompt:</strong> </p>'),lt=_('<div class="loading loading-spinner loading-lg text-primary"></div>'),ct=_('<button class="btn btn-outline btn-block h-auto py-4"><!> </button>'),dt=_('<button class="btn btn-outline"><!></button> <button class="btn btn-outline"><!></button>',1),ut=_('<button class="btn btn-outline"><!></button>'),vt=_('<button class="btn btn-ghost btn-block justify-start text-left h-auto py-3"><!> <span class="text-sm"> </span></button>'),mt=_('<div class="space-y-6"><div class="flex items-center justify-between"><div><h1 class="text-3xl font-bold text-base-content">🎼 Shivo Music Companion</h1> <p class="text-base-content/70 mt-2">Voice-controlled music generation with AI</p></div> <div class="flex gap-3"><!></div></div> <div class="card bg-base-100 shadow-lg"><div class="card-body"><div class="flex items-center gap-4"><div class="flex-1"><h3 class="font-semibold text-lg mb-2">Status</h3> <p class="text-base-content/80"> </p> <!></div> <!></div></div></div> <div class="card bg-base-100 shadow-lg"><div class="card-body"><h3 class="font-semibold text-lg mb-4">🎙️ Voice Commands</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="p-4 bg-base-200 rounded-lg"><h4 class="font-medium mb-2">Music Generation</h4> <ul class="text-sm text-base-content/70 space-y-1"><li>• "Create a Tamil folk melody"</li> <li>• "Make devotional music with flute"</li> <li>• "Generate ambient background music"</li> <li>• "Play classical orchestral piece"</li></ul></div> <div class="p-4 bg-base-200 rounded-lg"><h4 class="font-medium mb-2">Controls</h4> <ul class="text-sm text-base-content/70 space-y-1"><li>• "Start humming" (records melody)</li> <li>• "Stop" or "Pause"</li> <li>• "Play" or "Resume"</li> <li>• "Volume up/down"</li></ul></div></div></div></div> <div class="card bg-base-100 shadow-lg"><div class="card-body"><h3 class="font-semibold text-lg mb-4">🎵 Quick Templates</h3> <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4"></div></div></div> <div class="card bg-base-100 shadow-lg"><div class="card-body"><h3 class="font-semibold text-lg mb-4">🎛️ Manual Controls</h3> <div class="flex flex-wrap gap-4 items-center"><div class="flex items-center gap-3"><!> <input type="range" min="0" max="1" step="0.1" class="range range-primary"/> <span class="text-sm font-medium w-12"> </span></div> <div class="flex gap-2"><!></div> <button class="btn btn-secondary"><!> Record Melody</button></div></div></div> <div class="card bg-base-100 shadow-lg"><div class="card-body"><h3 class="font-semibold text-lg mb-4">✏️ Custom Prompt</h3> <div class="flex gap-3"><input type="text" placeholder="Describe the music you want to generate..." class="input input-bordered flex-1"/> <button class="btn btn-primary"><!> Generate</button></div></div></div> <div class="card bg-base-100 shadow-lg"><div class="card-body"><h3 class="font-semibold text-lg mb-4">💡 Sample Prompts</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"></div></div></div></div>');function ft(n,c){qe(c,!1);let i=k("🎙️ Shivo is listening..."),v=k(!1),d=k(!1),h=k(!1),m=k(.8),f=k(""),C=k(""),B=null;function _e(e){const t=e.toLowerCase().trim();t.includes("start humming")||t.includes("record melody")?K():t.includes("stop")||t.includes("pause")?O():t.includes("play")||t.includes("resume")?X():t.includes("volume up")||t.includes("louder")?Y(Math.min(r(m)+.2,1)):t.includes("volume down")||t.includes("quieter")?Y(Math.max(r(m)-.2,0)):P(e)}async function P(e){try{s(d,!0),s(f,e),s(i,`🎧 Generating music for: "${e}"`);const t=Xe(e);s(C,t);const l=await Ye(t);await tt(l,{volume:r(m),onEnded:()=>{s(h,!1),s(i,"✅ Music playback completed")}}),s(h,!0),s(i,"✅ Music playback started")}catch(t){console.error("Music generation failed:",t),s(i,`❌ Error: ${t instanceof Error?t.message:"Unknown error"}`)}finally{s(d,!1)}}async function K(){try{s(i,"🎤 Recording your melody... (5 seconds)");const e=await at({duration:5,onError:p=>{s(i,`❌ Recording failed: ${p.message}`)}});s(i,"🎼 Processing your melody...");const t=await ot(e);await P("Build a musical track around this melody, add harmonies and accompaniment")}catch(e){console.error("Humming recording failed:",e),s(i,`❌ Recording failed: ${e instanceof Error?e.message:"Unknown error"}`)}}function O(){we(),s(h,!1),s(i,"⏹️ Playback stopped")}function X(){r(h)||(it(),s(h,!0),s(i,"▶️ Playback resumed"))}function Y(e){s(m,e),xe(r(m)),s(i,`🔊 Volume set to ${Math.round(r(m)*100)}%`)}function Z(){r(v)||(s(v,!0),s(i,"🎙️ Listening for voice commands..."),B=()=>Oe(),Ke({continuous:!0,onResult:e=>{console.log("Voice command:",e),_e(e)},onError:e=>{console.error("Speech capture error:",e),s(i,`❌ Speech error: ${e}`),s(v,!1)},onEnd:()=>{s(v,!1),s(i,"🎙️ Voice listening stopped")}}))}function ee(){B&&(B(),B=null),s(v,!1),s(i,"🎙️ Voice listening stopped")}const ke=[{key:"devotional",label:"Devotional",icon:"heroicons:sparkles"},{key:"folk",label:"Folk",icon:"heroicons:musical-note"},{key:"ambient",label:"Ambient",icon:"heroicons:cloud"},{key:"classical",label:"Classical",icon:"heroicons:building-library"},{key:"electronic",label:"Electronic",icon:"heroicons:bolt"},{key:"world",label:"World Music",icon:"heroicons:globe-asia-australia"}];function Ce(e){const t=Ze(e);P(t)}He(()=>{Z()}),We(()=>{ee(),we()}),Je();var D=mt(),z=o(D),te=u(o(z),2),Pe=o(te);{var Ae=e=>{var t=nt(),l=o(t);b(l,{icon:"heroicons:microphone",class:"w-5 h-5 mr-2"}),L(),a(t),g("click",t,ee),x(e,t)},Me=e=>{var t=rt(),l=o(t);b(l,{icon:"heroicons:microphone",class:"w-5 h-5 mr-2"}),L(),a(t),g("click",t,Z),x(e,t)};S(Pe,e=>{r(v)?e(Ae):e(Me,!1)})}a(te),a(z);var F=u(z,2),ie=o(F),ae=o(ie),I=o(ae),j=u(o(I),2),Se=o(j,!0);a(j);var Ee=u(j,2);{var Be=e=>{var t=st(),l=u(o(t));a(t),G(()=>M(l,` ${r(C)??""}`)),x(e,t)};S(Ee,e=>{r(C)&&e(Be)})}a(I);var Ve=u(I,2);{var Te=e=>{var t=lt();x(e,t)},Re=e=>{var t=$e(),l=he(t);{var p=w=>{b(w,{icon:"heroicons:speaker-wave",class:"w-8 h-8 text-success"})},y=w=>{b(w,{icon:"heroicons:speaker-x-mark",class:"w-8 h-8 text-base-content/50"})};S(l,w=>{r(h)?w(p):w(y,!1)},!0)}x(e,t)};S(Ve,e=>{r(d)?e(Te):e(Re,!1)})}a(ae),a(ie),a(F);var U=u(F,4),oe=o(U),ne=u(o(oe),2);be(ne,5,()=>ke,pe,(e,t)=>{var l=ct(),p=o(l);b(p,{get icon(){return r(t).icon},class:"w-6 h-6 mb-2"});var y=u(p);a(l),G(()=>{l.disabled=r(d),M(y,` ${r(t).label??""}`)}),g("click",l,()=>Ce(r(t).key)),x(e,l)}),a(ne),a(oe),a(U);var H=u(U,2),re=o(H),se=u(o(re),2),W=o(se),le=o(W);b(le,{icon:"heroicons:speaker-wave",class:"w-5 h-5"});var V=u(le,2);ge(V);var ce=u(V,2),Ne=o(ce);a(ce),a(W);var q=u(W,2),Ge=o(q);{var Le=e=>{var t=dt(),l=he(t),p=o(l);b(p,{icon:"heroicons:stop",class:"w-5 h-5"}),a(l);var y=u(l,2),w=o(y);b(w,{icon:"heroicons:pause",class:"w-5 h-5"}),a(y),g("click",l,O),g("click",y,function(...Ie){J==null||J.apply(this,Ie)}),x(e,t)},De=e=>{var t=ut(),l=o(t);b(l,{icon:"heroicons:play",class:"w-5 h-5"}),a(t),g("click",t,X),x(e,t)};S(Ge,e=>{r(h)?e(Le):e(De,!1)})}a(q);var T=u(q,2),ze=o(T);b(ze,{icon:"heroicons:microphone",class:"w-5 h-5 mr-2"}),L(),a(T),a(se),a(re),a(H);var Q=u(H,2),de=o(Q),ue=u(o(de),2),R=o(ue);ge(R);var N=u(R,2),Fe=o(N);b(Fe,{icon:"heroicons:sparkles",class:"w-5 h-5 mr-2"}),L(),a(N),a(ue),a(de),a(Q);var ve=u(Q,2),me=o(ve),fe=u(o(me),2);be(fe,4,()=>["Shivo, make a Tamil folk melody with ambient pads","Create a devotional tune with flute and tanpura","Generate a chill beat with soft percussion and strings","Classical orchestral piece with piano and strings","Electronic ambient music with synthesizers","World music fusion with traditional instruments"],pe,(e,t)=>{var l=vt(),p=o(l);b(p,{icon:"heroicons:chat-bubble-left",class:"w-4 h-4 mr-3 flex-shrink-0"});var y=u(p,2),w=o(y,!0);a(y),a(l),G(()=>{l.disabled=r(d),M(w,t)}),g("click",l,()=>P(t)),x(e,l)}),a(fe),a(me),a(ve),a(D),G((e,t)=>{M(Se,r(i)),M(Ne,`${e??""}%`),T.disabled=r(d),N.disabled=t},[()=>Math.round(r(m)*100),()=>r(d)||!r(f).trim()]),ye(V,()=>r(m),e=>s(m,e)),g("input",V,()=>xe(r(m))),g("click",T,K),ye(R,()=>r(f),e=>s(f,e)),g("keydown",R,e=>{e.key==="Enter"&&r(f).trim()&&P(r(f))}),g("click",N,()=>r(f)&&P(r(f))),x(n,D),Qe()}function St(n){ft(n,{})}export{St as component};
